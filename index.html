<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width">
  <title>Occidental Dictionary Search</title>

  <!-- 
  Dark and Light Themes 
  -->
  <script>
  // If `prefers-color-scheme` is not supported, fall back to light mode.
  // In this case, light.css will be downloaded with `highest` priority.
  if (window.matchMedia('(prefers-color-scheme: dark)').media === 'not all') {
      document.documentElement.style.display = 'none';
      document.head.insertAdjacentHTML(
          'beforeend',
          '<link rel="stylesheet" href="style/light.css" onload="document.documentElement.style.display = \'\'">'
      );
  }
  </script>
  <link rel="stylesheet" href="style/dark.css" media="(prefers-color-scheme: dark)">
  <link rel="stylesheet" href="style/light.css" media="(prefers-color-scheme: no-preference), (prefers-color-scheme: light)">
  <link rel="stylesheet" href="style/style.css">
  <link href="https://fonts.googleapis.com/css?family=Merriweather|Montserrat&display=swap" rel="stylesheet">

</head>

<body>
  <header>
    <h1>Occidental Dictionary Search</h1>
    <button value="en" onclick="getDictionary(this)">English</button>
    <button value="cn" onclick="getDictionary(this)">中文</button>
    <button value="ru" onclick="getDictionary(this)">Русский</button>
  </header>

  <br><hr>

  <div id="data">
    <div id="dictionary_search"></div>
    <div id="parsed_csv_list"></div>
  </div>
  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jets/0.14.1/jets.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.1.0/papaparse.min.js"></script>
  <script src="script.js"></script>
  <script>
    function getDictionary(element) {
      var languageISO = element.value;
      
      var searchPlaceholder = '';
      switch (languageISO) {
        case 'en':
          searchPlaceholder = "search";
          break;
        case 'ru':
          searchPlaceholder = "поиска";
          break;
        case 'cn':
          searchPlaceholder = "搜索";
          break;
        default:
          searchPlaceholder = "search";
      }

      console.log(languageISO);
      var csvURL = "data/" + languageISO + "-ie.csv";

      $("#parsed_csv_list").empty();
      $("#dictionary_search").empty();
      $("#dictionary_search").html("<input placeholder=" + searchPlaceholder + " type='search' id='jetsSearch'>");

      Papa.parse(csvURL, {
        download: true,
        header: false,
        //worker: true,
        //step: function(row) {
        //  console.log("Row:", row.data);
        //},
        complete: displayHTMLTable
      });
    }

    function displayHTMLTable(results){
      var table = "<table class='table'><thead><tr>";
      var data = results.data;
      var header = data.shift;
      header.forEach(function(item, index) {
        table+= "<th>" + item + "</th>";
      })
      table+= "</tr></thead><tbody id='jetsContent'>";

      for(i=0;i<data.length;i++){
        table+= "<tr>";
        var row = data[i];

        for(j=0;j<row.length;j++){
          table+= "<td>" + cells[j] + "</td>";
        }
        table+= "</tr>";
      }
      table+= "</tbody></table>";
      $("#parsed_csv_list").html(table);
      var jets = new Jets({
        searchTag: '#jetsSearch',
        contentTag: '#jetsContent',
        columns: [0] // Only search native language first column
      });
    }
  </script>
 </body>
 
</html>
